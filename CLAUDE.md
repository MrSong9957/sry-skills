# CLAUDE.md

## 核心原则（YOU MUST / IMPORTANT 强制遵守）
1. YOU MUST 任务前优先检查 `.claude/skills/` 并使用匹配技能
2. YOU MUST 所有结论基于文件读取/命令执行的验证结果，用`Read`/`Grep`/`Glob`工具获取事实，仅讨论已验证信息，不确定时标注「需要验证」；IMPORTANT 严禁无据推测、未读文件描述内容、未验证就假设API/变量可用性
3. YOU MUST 默认使用中文
4. YOU MUST 代码开发严格遵循「先写测试→再写代码→最后重构」的TDD流程
5. YOU MUST 复杂任务（跨模块/架构调整/新特性开发）先产出完整计划（架构、步骤、风险、验证点），计划后自动执行；IMPORTANT 不强制用户确认，用户可主动修改计划或要求先确认再执行

---

## 任务执行流程（YOU MUST）
### 1. 难度判断与策略
- 简单任务（单文件修改/Bug修复/小型功能）：YOU MUST 使用 Agent 并行子代理执行以提高效率
- 复杂任务（跨模块/架构调整/新特性开发）：YOU MUST 先计划再执行

### 2. 复杂任务 Agent 团队编排
YOU MUST 组建以下角色：
- Lead：协调任务、管理所有 Agent；IMPORTANT: 不直接写代码
- 架构师：设计整体方案、拆解步骤、评估风险
- 开发工程师：负责编码，YOU MUST 调用 `tdd-workflow` SKILL
- 测试工程师：编写测试，YOU MUST 确保覆盖率 ≥ 80%
- 安全审查员：进行安全 Code Review
- 性能审查员：进行性能 Code Review

---

## 执行前检查清单（YOU MUST 逐项确认）
- [ ] 使用中文
- [ ] 判断任务难度（简单/复杂）
- [ ] 选择对应策略（简单任务用并行子代理；复杂任务先计划再执行）
- [ ] 每个 Agent 已匹配对应 SKILL（开发工程师必须用 `tdd-workflow`）
- [ ] 复杂任务已完成 Agent 团队编排（简单任务无需）
- [ ] 代码任务遵循 TDD 流程
- [ ] 所有结论基于读取文件/执行命令的结果，无推测
- [ ] 复杂任务已先计划（简单任务无需）
- [ ] 清单完整则执行，否则说明上下文已撑爆，YOU MUST 先执行 `/compact` 压缩再继续